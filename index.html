<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é©¬æ‹‰æ¾è®­ç»ƒæ—¥è®° V3.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f3f4f6; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        .card { transition: all 0.2s; }
        .card:active { transform: scale(0.98); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* åŠ¨ä½œæ‰“å¡æ ·å¼ä¼˜åŒ– */
        .action-item { transition: all 0.2s; }
        .action-item.checked { background-color: #effdf5; border-color: #86efac; }
        .action-item.checked .check-box { background-color: #22c55e; border-color: #22c55e; }
        .action-item.checked .action-name { color: #166534; text-decoration: line-through; opacity: 0.8; }
    </style>
</head>
<body class="pb-24">

    <div class="bg-blue-700 text-white p-4 sticky top-0 z-20 shadow-md">
        <div class="flex justify-between items-center mb-3">
            <h1 class="text-lg font-bold">ğŸƒâ€â™‚ï¸ 26å‘¨æŒ‘æˆ˜</h1>
            <div class="flex space-x-2">
                <button onclick="generateReport()" class="bg-green-500 text-xs px-3 py-1.5 rounded shadow hover:bg-green-600 font-medium">
                    ğŸ“‹ å¤åˆ¶
                </button>
                <button onclick="backupToEmail()" class="bg-gray-100 text-blue-700 text-xs px-3 py-1.5 rounded shadow hover:bg-white font-bold flex items-center">
                    ğŸ“© é‚®ä»¶å¤‡ä»½
                </button>
            </div>
        </div>
        
        <select id="week-selector" onchange="changeWeek()" class="w-full p-2 text-black rounded-lg outline-none font-bold shadow-inner bg-blue-50">
            <option value="1">ç¬¬1å‘¨ï¼šåŸºç¡€ä¸ä¿®å¤ (11/20-11/26)</option>
            <option value="2">ç¬¬2å‘¨ï¼šä¿æŒè¿è´¯æ€§ (11/27-12/03)</option>
            <option value="3">ç¬¬3å‘¨ï¼šä¸“æ³¨å§¿åŠ¿ (12/04-12/10)</option>
            <option value="4">ç¬¬4å‘¨ï¼šå‡é‡ä¼‘æ¯ (12/11-12/17)</option>
        </select>
    </div>

    <div class="px-4 pt-4">
        <div class="flex justify-between text-xs text-gray-500 mb-1">
            <span>æœ¬å‘¨è¿›åº¦</span>
            <span id="progress-text">0/7</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2.5">
            <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
    </div>

    <div id="schedule-list" class="p-4 space-y-3">
        </div>

    <div id="modal" class="fixed inset-0 bg-black bg-opacity-60 hidden flex items-end justify-center z-50 backdrop-blur-sm">
        <div class="bg-white w-full rounded-t-2xl p-6 h-5/6 overflow-y-auto animate-slide-up flex flex-col">
            <div class="flex justify-between items-center mb-4 flex-shrink-0">
                <h2 class="text-xl font-bold text-blue-800" id="modal-title">ç¼–è¾‘è®°å½•</h2>
                <button onclick="closeModal()" class="text-gray-400 text-2xl">&times;</button>
            </div>
            
            <div class="space-y-5 flex-grow overflow-y-auto pb-20">
                
                <div id="action-section">
                    <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ’ª ä»Šæ—¥åŠ¨ä½œ (ç‚¹å‡»æŸ¥çœ‹è¦ç‚¹å¹¶å‹¾é€‰)</label>
                    <div id="action-list" class="space-y-2">
                        </div>
                </div>

                <div class="border-t pt-4">
                    <label class="block text-sm font-bold text-gray-700 mb-1">âœ… è·‘æ­¥æ•°æ® / å®é™…å®Œæˆ</label>
                    <input type="text" id="input-result" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none" placeholder="ä¾‹ï¼š5.02å…¬é‡Œï¼Œ35åˆ†é’Ÿ">
                </div>

                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">ğŸ¦µ èº«ä½“æ„Ÿå— (è†ç›–/é«‚èƒ«æŸ)</label>
                    <textarea id="input-feeling" rows="2" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none" placeholder="è†ç›–å†…ä¾§æ„Ÿè§‰å¦‚ä½•ï¼Ÿ"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">ğŸ“‰ ç—›æ„Ÿæ‰“åˆ† (0-10)</label>
                    <div class="flex space-x-2 overflow-x-auto py-2 no-scrollbar">
                        <script>
                            for(let i=0; i<=10; i++) {
                                document.write(`<div onclick="selectPain(${i})" id="pain-btn-${i}" class="pain-btn flex-shrink-0 w-10 h-10 rounded-full border flex items-center justify-center cursor-pointer font-bold ${i>=3 ? 'border-red-200 text-red-600' : 'border-green-200 text-green-600'}">${i}</div>`);
                            }
                        </script>
                    </div>
                    <input type="hidden" id="input-pain">
                </div>
                
                <div class="h-10"></div> </div>

            <div class="absolute bottom-0 left-0 w-full p-4 bg-white border-t border-gray-100">
                <button onclick="saveData()" class="w-full bg-blue-600 active:bg-blue-700 text-white py-3 rounded-xl font-bold text-lg shadow-lg">ä¿å­˜æ‰“å¡</button>
            </div>
        </div>
    </div>

    <script>
        // ================= æ•°æ®å®šä¹‰ (åŒ…å«åŠ¨ä½œè¦ç‚¹ V3.1) =================
        const masterPlan = [
            // ç¬¬1å‘¨
            { 
                week: 1, date: "11/20 (å‘¨å››)", task: "è½»æ¾è·‘ 5å…¬é‡Œ", focus: "è·‘é“è½¨ (åŒè„šåˆ†å®½)", 
                actions: [
                    {name: "è·‘é“è½¨å§¿åŠ¿ç¡®è®¤", desc: "æƒ³è±¡åœ°ä¸Šæœ‰ä¸¤æ¡è½¨ï¼Œå·¦è„šè¸©å·¦è½¨ï¼Œå³è„šè¸©å³è½¨ï¼Œé—´è·10cm", done: false},
                    {name: "è·‘åæ‹‰ä¼¸ (è´è¶å¼)", desc: "è„šå¿ƒç›¸å¯¹ï¼ŒèƒŒæŒºç›´ï¼Œè†ç›–å‘ä¸‹å‹ï¼Œä¿æŒ30ç§’", done: false},
                    {name: "ç¡å‰ VMO æ¿€æ´» (10æ¬¡)", desc: "åå§¿ä¼¸ç›´è…¿ï¼Œæ‰‹æŒ‡æŒ‰ä½è†ç›–å†…ä¸Šæ–¹è‚Œè‚‰ï¼Œç”¨åŠ›æ”¶ç¼©å˜ç¡¬", done: false}
                ] 
            },
            { 
                week: 1, date: "11/21 (å‘¨äº”)", task: "ä¼‘æ¯ & æ‹‰ä¼¸", focus: "é‡ç‚¹æ‹‰ä¼¸å†…ä¾§", 
                actions: [
                    {name: "è´è¶å¼æ‹‰ä¼¸ (3ç»„)", desc: "é’ˆå¯¹å¤§è…¿å†…ä¾§ï¼Œä¸è¦ç”¨åŠ›çŒ›å‹ï¼Œæœ‰æ‹‰ä¼¸æ„Ÿå³å¯", done: false},
                    {name: "å¤§è…¿åä¾§æ‹‰ä¼¸", desc: "è„šè·Ÿæ¶é«˜ï¼Œå‹¾è„šå°–ï¼Œèº«ä½“å‰å€¾ï¼Œæ„Ÿå—å¤§è…¿åä¾§æ‹‰ä¼¸", done: false},
                    {name: "æ³¡æ²«è½´æ»šè‡€éƒ¨", desc: "é’ˆå¯¹å±è‚¡è‚Œè‚‰æ»šå‹ï¼Œä¸¥ç¦æ»šå‹è†ç›–å†…ä¾§ç—›ç‚¹ï¼", done: false}
                ]
            },
            { 
                week: 1, date: "11/22 (å‘¨å…­)", task: "é•¿è·ç¦»è·‘ 8å…¬é‡Œ", focus: "è·‘4èµ°1 | é˜²å†…æ‰£", 
                actions: [
                    {name: "ä¸¥æ ¼è·‘4èµ°1", desc: "æ‰‹æœºè®¾å®š4åˆ†é’Ÿè·‘ï¼Œ1åˆ†é’Ÿèµ°ï¼Œä¸çœ‹é…é€Ÿçœ‹æ—¶é—´", done: false},
                    {name: "é˜²å†…æ‰£æ„è¯†", desc: "è½åœ°æ—¶è†ç›–å‘ç¬¬äºŒè„šè¶¾æ–¹å‘çœ‹é½ï¼Œä¸è¦å‘å†…å€’", done: false},
                    {name: "è·‘åæ‹‰ä¼¸å…¨å¥—", desc: "è‡€éƒ¨ã€å¤§è…¿å‰åä¾§ã€å†…ä¾§éƒ½è¦æ‹‰ä¼¸", done: false}
                ]
            },
            { 
                week: 1, date: "11/23 (å‘¨æ—¥)", task: "å¿«èµ° 45åˆ† + æ ¸å¿ƒ", focus: "æœ‰æ°§ + æ ¸å¿ƒå¼ºåŒ–", 
                actions: [
                    {name: "å¿«èµ° 45åˆ†é’Ÿ", desc: "æ‘†è‡‚å¹…åº¦å¤§ï¼Œæ­¥ä¼å¿«ï¼Œèº«ä½“å¾®å¾®å‡ºæ±—", done: false},
                    {name: "å¹³æ¿æ”¯æ’‘ (3ç»„x60ç§’)", desc: "èº«ä½“æˆä¸€æ¡ç›´çº¿ï¼Œæ”¶ç´§æ ¸å¿ƒï¼Œä¸è¦å¡Œè…°", done: false},
                    {name: "æ­»è™«å¼ (3ç»„x15æ¬¡)", desc: "è…°èƒŒç´§è´´åœ°é¢ï¼Œå¯¹ä¾§æ‰‹è„šä¼¸å±•ï¼Œå‘¼å¸é…åˆ", done: false},
                    {name: "ä¿¯å§æ’‘ (3ç»„)", desc: "å¸¸è§„æˆ–è·ªå§¿ï¼Œæ„Ÿå—èƒ¸è‚Œå’Œæ‰‹è‡‚å‘åŠ›", done: false}
                ]
            },
            { 
                week: 1, date: "11/24 (å‘¨ä¸€)", task: "ä¼‘æ¯", focus: "å½»åº•æ”¾æ¾", 
                actions: [
                    {name: "å……è¶³ç¡çœ ", desc: "ä¿è¯8å°æ—¶ç¡çœ ï¼Œä¿®å¤è‚Œè‚‰ç»„ç»‡", done: false}
                ]
            },
            { 
                week: 1, date: "11/25 (å‘¨äºŒ)", task: "è½»æ¾è·‘ 5å…¬é‡Œ", focus: "è½åœ°è½»ç›ˆ", 
                actions: [
                    {name: "è·‘æ­¥ 5km", desc: "æ ¸å¿ƒæ”¶ç´§ï¼Œæƒ³è±¡å¤´é¡¶æœ‰çº¿æ‹‰ç€", done: false},
                    {name: "VMO æ¿€æ´» (10æ¬¡)", desc: "åå§¿ä¼¸ç›´è…¿ç”¨åŠ›æ”¶ç¼©å†…ä¾§å¤´ï¼Œæ¯æ¬¡ä¿æŒ5ç§’", done: false}
                ]
            },
            { 
                week: 1, date: "11/26 (å‘¨ä¸‰)", task: "åŠ›é‡è®­ç»ƒ (è…¿éƒ¨)", focus: "é å¢™å¤¹çƒ + èšŒå¼", 
                actions: [
                    {name: "é å¢™å¤¹çƒé™è¹² (3ç»„x45ç§’)", desc: "èƒŒè´´å¢™ï¼Œè†ç›–å¤¹çƒ/æ¯›å·¾ï¼Œå¤§è…¿æ°´å¹³ï¼Œæ¿€æ´»å†…ä¾§å¤´", done: false},
                    {name: "èšŒå¼å¼€åˆ (3ç»„x15æ¬¡)", desc: "ä¾§å§ï¼Œéª¨ç›†å‚ç›´åœ°é¢ä¸è¦ç¿»è½¬ï¼Œè‡€å¤–ä¾§å‘åŠ›", done: false},
                    {name: "ä¾§å§æŠ¬è…¿ (3ç»„x15æ¬¡)", desc: "è„šå°–æœä¸‹(å†…æ—‹)ï¼Œç›´è…¿ä¸ŠæŠ¬ï¼Œé’ˆå¯¹è‡€ä¸­è‚Œ", done: false},
                    {name: "ç›´è…¿å†…æ”¶ (3ç»„x15æ¬¡)", desc: "ä¾§å§ï¼Œä¸‹æ–¹è…¿ç”¨åŠ›ä¸ŠæŠ¬ï¼Œé’ˆå¯¹å¤§è…¿å†…ä¾§", done: false}
                ]
            },
            
            // ç¬¬2å‘¨
            { week: 2, date: "11/27 (å‘¨å››)", task: "è½»æ¾è·‘ 6å…¬é‡Œ", focus: "ç»´æŒåŒè„šå®½åº¦", actions: [{name: "è·‘æ­¥ 6km", desc: "ä¿æŒè·‘é“è½¨è·‘å§¿", done: false}, {name: "VMO æ¿€æ´»", desc: "æ¯ä¾§10æ¬¡ï¼Œæ¯æ¬¡5ç§’é¡¶å³°æ”¶ç¼©", done: false}] },
            { week: 2, date: "11/28 (å‘¨äº”)", task: "ä¼‘æ¯", focus: "æ‹‰ä¼¸", actions: [{name: "è´è¶å¼æ‹‰ä¼¸", desc: "ä¿æŒèƒŒéƒ¨æŒºç›´", done: false}] },
            { week: 2, date: "11/29 (å‘¨å…­)", task: "é•¿è·ç¦»è·‘ 9å…¬é‡Œ", focus: "è·‘4èµ°1", actions: [{name: "è·‘9km (è·‘èµ°ç»“åˆ)", desc: "è·‘4åˆ†èµ°1åˆ†ï¼Œæ³¨æ„è†ç›–å†…ä¾§æ„Ÿå—", done: false}, {name: "è·‘åæ‹‰ä¼¸", desc: "å…¨å¥—ä¸‹è‚¢æ‹‰ä¼¸", done: false}] },
            { week: 2, date: "11/30 (å‘¨æ—¥)", task: "å¿«èµ° 45åˆ† + æ ¸å¿ƒ", focus: "å¢åŠ æ ¸å¿ƒå¼ºåº¦", actions: [{name: "å¿«èµ°45min", desc: "ä¿æŒé…é€Ÿ", done: false}, {name: "å¹³æ¿æ”¯æ’‘", desc: "å¢åŠ 10ç§’æˆ–è´Ÿé‡", done: false}, {name: "æ­»è™«å¼", desc: "åŠ¨ä½œæ”¾æ…¢ï¼Œæ§åˆ¶æ ¸å¿ƒ", done: false}] },
            { week: 2, date: "12/01 (å‘¨ä¸€)", task: "ä¼‘æ¯", focus: "æ¢å¤", actions: [{name: "ä¼‘æ¯", desc: "å½»åº•æ”¾æ¾", done: false}] },
            { week: 2, date: "12/02 (å‘¨äºŒ)", task: "è½»æ¾è·‘ 5å…¬é‡Œ", focus: "æ­¥é¢‘180", actions: [{name: "è·‘æ­¥ 5km", desc: "å°æ­¥å¿«è·‘ï¼Œå‡å°‘è§¦åœ°æ—¶é—´", done: false}, {name: "VMO æ¿€æ´»", desc: "æ—¥å¸¸ä¿å…»", done: false}] },
            { week: 2, date: "12/03 (å‘¨ä¸‰)", task: "åŠ›é‡è®­ç»ƒ (è…¿éƒ¨)", focus: "å¢åŠ é™è¹²æ—¶é—´", actions: [{name: "é å¢™å¤¹çƒ (3ç»„x60ç§’)", desc: "å¢åŠ æ—¶é—´åˆ°60ç§’", done: false}, {name: "èšŒå¼å¼€åˆ (4ç»„)", desc: "å¢åŠ ä¸€ç»„", done: false}] },

             // ç¬¬3å‘¨
            { week: 3, date: "12/04 (å‘¨å››)", task: "è½»æ¾è·‘ 6å…¬é‡Œ", focus: "å‘¼å¸", actions: [{name: "è·‘æ­¥ 6km", desc: "ä¸‰æ­¥ä¸€å‘¼ä¸‰æ­¥ä¸€å¸", done: false}] },
            { week: 3, date: "12/05 (å‘¨äº”)", task: "ä¼‘æ¯", focus: "æ‹‰ä¼¸", actions: [{name: "æ‹‰ä¼¸", desc: "å…¨èº«æ”¾æ¾", done: false}] },
            { week: 3, date: "12/06 (å‘¨å…­)", task: "é•¿è·ç¦»è·‘ 10å…¬é‡Œ", focus: "çªç ´åŒä½æ•°", actions: [{name: "è·‘10km", desc: "è·‘4èµ°1ï¼Œå…³æ³¨ä½“èƒ½åˆ†é…", done: false}] },
            { week: 3, date: "12/07 (å‘¨æ—¥)", task: "å¿«èµ° 50åˆ† + æ ¸å¿ƒ", focus: "è€åŠ›", actions: [{name: "å¿«èµ°50min", desc: "å»¶é•¿æ—¶é—´", done: false}, {name: "æ ¸å¿ƒè®­ç»ƒ", desc: "å…¨å¥—æ ¸å¿ƒåŠ¨ä½œ", done: false}] },
            { week: 3, date: "12/08 (å‘¨ä¸€)", task: "ä¼‘æ¯", focus: "æ¢å¤", actions: [{name: "ä¼‘æ¯", desc: "", done: false}] },
            { week: 3, date: "12/09 (å‘¨äºŒ)", task: "è½»æ¾è·‘ 6å…¬é‡Œ", focus: "æ”¾æ¾", actions: [{name: "è·‘æ­¥ 6km", desc: "è‚©è†€ä¸‹æ²‰æ”¾æ¾", done: false}] },
            { week: 3, date: "12/10 (å‘¨ä¸‰)", task: "åŠ›é‡è®­ç»ƒ", focus: "å…¨å¥—è…¿éƒ¨", actions: [{name: "è…¿éƒ¨åŠ›é‡å…¨å¥—", desc: "ä¿æŒå¼ºåº¦", done: false}] },

            // ç¬¬4å‘¨
            { week: 4, date: "12/11 (å‘¨å››)", task: "è½»æ¾è·‘ 5å…¬é‡Œ", focus: "è½»æ¾", actions: [{name: "è·‘æ­¥ 5km", desc: "å‡é‡è·‘ï¼Œå¾ˆè½»æ¾", done: false}] },
            { week: 4, date: "12/12 (å‘¨äº”)", task: "ä¼‘æ¯", focus: "ç¡çœ ", actions: [{name: "ä¼‘æ¯", desc: "", done: false}] },
            { week: 4, date: "12/13 (å‘¨å…­)", task: "é•¿è·ç¦»è·‘ 8å…¬é‡Œ", focus: "å‡é‡", actions: [{name: "è·‘8km", desc: "ç¼©çŸ­è·ç¦»ï¼Œèº«ä½“å……ç”µ", done: false}] },
            { week: 4, date: "12/14 (å‘¨æ—¥)", task: "å¿«èµ° 30åˆ†", focus: "æ”¾æ¾", actions: [{name: "å¿«èµ°30min", desc: "éšä¾¿èµ°èµ°", done: false}] },
            { week: 4, date: "12/15 (å‘¨ä¸€)", task: "ä¼‘æ¯", focus: "æ¢å¤", actions: [{name: "ä¼‘æ¯", desc: "", done: false}] },
            { week: 4, date: "12/16 (å‘¨äºŒ)", task: "è½»æ¾è·‘ 4å…¬é‡Œ", focus: "çŠ¶æ€", actions: [{name: "è·‘æ­¥ 4km", desc: "æ£€æŸ¥èº«ä½“çŠ¶æ€", done: false}] },
            { week: 4, date: "12/17 (å‘¨ä¸‰)", task: "åŠ›é‡è®­ç»ƒ (è½»)", focus: "è‡ªé‡è®­ç»ƒ", actions: [{name: "è½»é‡æ·±è¹²", desc: "ä¸è´Ÿé‡", done: false}, {name: "è½»é‡èšŒå¼", desc: "ä¸ç”¨å¼¹åŠ›å¸¦", done: false}] },
        ];

        let userPlan = [];
        let currentWeek = 1;
        let currentIndex = null;

        function init() {
            const storedData = JSON.parse(localStorage.getItem('marathonPlan_v3')) || [];
            
            userPlan = masterPlan.map((item, index) => {
                const saved = storedData[index];
                let mergedActions = item.actions.map(act => ({ ...act }));

                if (saved && saved.actions) {
                    mergedActions = item.actions.map((act, i) => {
                        if (saved.actions[i] && saved.actions[i].name === act.name) {
                            return { ...act, done: saved.actions[i].done };
                        }
                        return act;
                    });
                }

                return {
                    ...item,
                    actions: mergedActions,
                    result: saved ? saved.result : "",
                    feeling: saved ? saved.feeling : "",
                    pain: saved ? saved.pain : "",
                    done: saved ? saved.done : false
                };
            });
            render();
        }

        function changeWeek() {
            currentWeek = parseInt(document.getElementById('week-selector').value);
            render();
        }

        function render() {
            const list = document.getElementById('schedule-list');
            list.innerHTML = '';
            const weekTasks = userPlan.filter(item => item.week === currentWeek);
            const doneCount = weekTasks.filter(t => t.done).length;
            
            document.getElementById('progress-text').innerText = `${doneCount}/${weekTasks.length}`;
            document.getElementById('progress-bar').style.width = `${(doneCount/weekTasks.length)*100}%`;

            weekTasks.forEach((item) => {
                const realIndex = userPlan.indexOf(item);
                const statusClass = item.done ? 'bg-green-50 border-green-500 border-l-4' : 'bg-white border-l-4 border-blue-200';
                const icon = item.done ? 'âœ…' : 'â­•ï¸';
                const painBadge = item.pain ? `<span class="ml-2 text-xs px-2 py-0.5 rounded ${item.pain > 2 ? 'bg-red-100 text-red-600' : 'bg-green-100 text-green-600'}">ç—›æ„Ÿ:${item.pain}</span>` : '';
                
                const actionDone = item.actions.filter(a => a.done).length;
                const actionTotal = item.actions.length;
                const actionBadge = actionTotal > 0 ? `<span class="text-xs text-blue-600 bg-blue-50 px-1 rounded ml-1">åŠ¨ä½œ:${actionDone}/${actionTotal}</span>` : '';

                const html = `
                    <div onclick="openModal(${realIndex})" class="card cursor-pointer rounded-xl p-4 shadow-sm flex justify-between items-start mb-3 ${statusClass}">
                        <div class="flex-1">
                            <div class="flex justify-between items-center mb-1">
                                <span class="font-bold text-gray-800 text-sm">${item.date.split(' ')[0]} <span class="font-normal text-gray-500">${item.date.split(' ')[1]}</span></span>
                                ${painBadge}
                            </div>
                            <div class="font-bold text-gray-900 mb-1">${item.task}</div>
                            <p class="text-xs text-gray-500 mb-2">ğŸ’¡ ${item.focus} ${actionBadge}</p>
                            ${item.done ? `<div class="text-xs text-gray-700 mt-2 border-t border-gray-200 pt-2 bg-opacity-50">ğŸ“ ${item.result} <br>â¤ï¸ ${item.feeling}</div>` : ''}
                        </div>
                        <div class="ml-3 text-xl mt-1">${icon}</div>
                    </div>
                `;
                list.innerHTML += html;
            });
        }

        function openModal(index) {
            currentIndex = index;
            const item = userPlan[index];
            document.getElementById('modal-title').innerText = item.task;
            document.getElementById('input-result').value = item.result;
            document.getElementById('input-feeling').value = item.feeling;
            selectPain(item.pain || 0);
            
            const actionList = document.getElementById('action-list');
            actionList.innerHTML = '';
            if (item.actions && item.actions.length > 0) {
                document.getElementById('action-section').classList.remove('hidden');
                item.actions.forEach((action, i) => {
                    const checkedClass = action.done ? 'checked' : 'bg-white border-gray-200';
                    const checkIcon = action.done ? 'âœ“' : '';
                    const checkBg = action.done ? 'bg-
